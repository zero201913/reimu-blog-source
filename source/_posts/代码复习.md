---
cover: https://image.acg.lol/file/2025/11/15/reimu-13.jpg
title: 复习jsp的系统设计
date: 2025-11-2 19:30:00
categories: Java编程语言
excerpt: 使用jsp+javaee开发规范，来开发一个小型管理系统，拥有两种身份
---

# 准备工作

## 创建数据库 init.sql

```sql
create database nlgamedb;
use nlgamedb;
create table user(
account varchar(20) primary key,
certificate varchar(20) not null,
authority varchar(20) not null
);
create table session
(
sessionid int primary key auto_increment,
item varchar(20) not null,
ground varchar(20) not null,
date varchar(20) not null
);

insert into user values('aaa','111','admin');
insert into user values('bbb','222','user');
insert into session(item,ground,date) values('篮球','珠海市金湾区公路','11月12日');

select * from user;
select * from session;
```

## 创建实体类 entity.java

```java
package com;
public class Nationalgame {
    String account;
    String certificate;
    String authority;
    public String getAccount() {
        return account;
    }
    public void setAccount(String account) {
        this.account = account;
    }
    public String getCertificate() {
        return certificate;
    }
    public void setCertificate(String certificate) {
        this.certificate = certificate;
    }
    public String getAuthority() {
        return authority;
    }
    public void setAuthority(String authority) {
        this.authority = authority;
    }
}
```

# 登录功能

## 创建登录页面 login.jsp

```html
登录页面<br/>
<form action="checklogin.jsp" method="post" name="login">
请输入用户名：<input type="text" name="account"><br>
请输入密码：<input type="password" name="certificate"><br>
请选择权限：<input type="radio" name="authority" value="admin" checked>组委会
            <input type="radio" name="authority" value="user">观众<br>
            <input type="submit" value="登录" onclick="return validate();">
</form>
</body>
```


## 登录验证 login.jsp

```js
<script type="text/javascript">
function validate() {
    if (document.login.account.value == "") {
        alert("用户名不能为空！");
        return false;
    }
    if (document.login.certificate.value == "") {
        alert("密码不能为空！");
        return false;
    }
    return true;
}
</script>
```

## 登录逻辑 entity.java

在实体类中编写

```java
public Connection getConn() {
    Connection cn = null;
    try {
        Class.forName("com.mysql.jdbc.Driver");
        cn = DriverManager.getConnection("jdbc:mysql://127.0.0.1:3306/nlgamedb", "root", "123456");
    } catch (Exception e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    return cn;
}

public boolean login() {
    boolean flag = false;
    Statement st;
    try {
        st = getConn().createStatement();
        ResultSet rs = st.executeQuery("select * from user where account='" + account + "' and certificate='" + certificate + "' and authority='" + authority + "'");
        if (rs.next()) {
            flag = true;
        }
    } catch (Exception e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    return flag;
}
```


## 检查登录 checklogin.jsp

```jsp
<jsp:useBean id="login" class="com.nationalgame"></jsp:useBean>
 <jsp:setProperty property="*" name="login"/>
 <html>
    <body>
<%
request.setCharacterEncoding("gbk");
String authority = request.getParameter("authority");
if (login.login()) {
%>
<jsp:forward page="Servlet">
    <jsp:param value="<%=authority%>" name="authority"/>
</jsp:forward>
<%
} else {
%>
<jsp:forward page="Login.jsp">
    <jsp:param value="用户名或者密码错误" name="msg"/>
</jsp:forward>
<%
}
%>
```

## 编写登录跳转 Servlet.java

```java
//doGet方法
request.setCharacterEncoding("gbk");
response.setContentType("text/html;charset=gbk");
PrintWriter out = response.getWriter();
String authority = response.getParameter("authority");
if(authority.equals("admin"))
getServletConfig().getServletContext()
.getRequestDispatcher("/admin,jsp").forward(request,response);
else
getServletConfig().getServletContexxt()
.getRequestDispatcher("/user.jsp").forward(request,response);
out.flush();
out.close();
```

## 登录信息回显 login.jsp

```jsp
<%
request.setCharacterEncoding("gbk");
if(request.getParameter("msg")!=null)
out.print(request.getParameter("msg"));
%>
```

# 主页面 admin.jsp

```jsp
<%@ page language="java" import="java.util.*" pageEncoding="gbk"%>
<%@page import="java.sql.ResultSet"%>
<jsp:useBean id="login" class="com.nationalgame"></jsp:useBean>
<html>
<body>
    <%
        request.setChatacterEncoding("gbk");
        ResultSet rs=login.Query(0);
    %>
    <a href="add.jsp">新增比赛信息</a><br>
    <table border="1">
        <tr>
            <th>场次编号</th>
            <th>比赛项目</th>
            <th>比赛场地</th>
            <th>比赛日期</th>
            <th colspan="2">操作</th>
        </tr>
        <% while(rs.next()){ %>
        <tr>
            <td><%=rs.getString(1)%></td>
            <td><%=rs.getString(2)%></td>
            <td><%=rs.getString(3)%></td>
            <td><%=rs.getString(4)%></td>
            <td><a href="delete.jsp?id=<%=rs.getString(1)%>">删除</a></td>
            <td><a href="update.jsp?id=<%=rs.getString(2)%>">修改</a></td>
        </tr>
        <% } %>
    </table>
</body>
</html>
```

## 查询方法 entity.java

```java
public ResultSet Query(int id){
    ResultSet rs=null;
    try{
        Statement st=getConn().createStatement();
        if(id==0)
            rs=st.executeQuery("select*from session");
        else
            rs=st.executeQuery("select*from session where sessionid="+id);
    }catch(Exception e){
        e.printStackTrace();
    }
    return rs;
 }
```

# 子页面 user.jsp

```jsp
<%@ page language="java" import="java.util.*" pageEncoding="gbk"%>
<%@page import="java.sql.ResultSet"%>
<jsp:useBean id="login" class="com.nationalgame"></jsp:useBean>
<html>
<body>
    <%
        request.setChatacterEncoding("gbk");
        ResultSet rs=login.Query(0);
    %>
    <table border="1">
        <tr>
            <th>场次编号</th>
            <th>比赛项目</th>
            <th>比赛场地</th>
            <th>比赛日期</th>
            <th colspan="2">操作</th>
        </tr>
        <% while(rs.next()){ %>
        <tr>
            <td><%=rs.getString(1) %></td>
            <td><%=rs.getString(2) %></td>
            <td><%=rs.getString(3) %></td>
            <td><%=rs.getString(4) %></td>
        </tr>
        <% } %>
    </table>
</body>
</html>
```

# 添加功能 add.jsp

```jsp
<%@ page language="java" import="java.util.*" pageEncoding="gbk"%>
<jsp:useBean id="login" class="com.nationalgame"></jsp:useBean>
<html>
<body>
    新增比赛信息<br>
    <form action="checkadd.jsp" method="post">
        请输入比赛项目：<input type="text" name="item"><br>
        请输入比赛场地：<input type="text" name="ground"><br>
        请输入比赛日期：<input type="text" name="date"><br>
        <input type="submit" value="添加">
    </form>
</body>
</html>
```

## 检查新增 checkadd.jsp

```jsp
 <% 
    request.setCharacterEncoding("gbk");
    String item=request.getParameter("item");
    String ground=request.getParameter("ground");
    String date=request.getParameter("date");
    ArrayList list=new ArrayList();
    list.add(item);
    list.add(ground);
    list.add(date);
    login.Insert(list);
    response.sendRedirect("admin.jsp");
%>
```


## 新增方法 entity.java
```java
public void Insert(ArrayList list){
    try{
        Statement st=getConn().createStatement();
        st.executeUpdate("insert into session(item,groud,date) 
                         
value('"+list.get(0)+"','"+list.get(1)+"','"+list.get(2)+"')");
    }catch(Exception e){
        e.printStackTrace();
    }
 }
```

# 删除功能 delete.jsp

```jsp
<%
request.setCharacterEncoding("gbk");
int id = Integer.parseInt(request.getParameter("id"));
login.Delete(id);
response.sendRedirect("admin.jsp");
%>
```


## 删除方法 entity.java
```java
public void Delete(int id) {
    try {
        Statement st = getConn().createStatement();
        st.executeUpdate("delete from session where sessionid=" + id);
    } catch (Exception e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
}
```


# 更新页面 update.jsp

```jsp
<body>
<%
request.setCharacterEncoding("gbk");
int id = Integer.parseInt(request.getParameter("id"));
ResultSet rs = login.Query(id);
if(rs.next()){
%>
修改比赛信息<br/><br/>
<form action="checkupdate.jsp" method="post">
    <input type="hidden" name="id" value="<%=rs.getString(1)%>">
    请输入比赛项目：<input type="text" name="item" value="<%=rs.getString(2)%>"><br>
    请输入比赛场地：<input type="text" name="ground" value="<%=rs.getString(3)%>"><br>
    请输入比赛日期：<input type="text" name="date" value="<%=rs.getString(4)%>"><br>
    <input type="submit" value="修改">
</form>
<%
}
%>
</body>
```


## 检查更新 updatecheck.jsp


```jsp
<%
request.setCharacterEncoding("gbk");
int id = Integer.parseInt(request.getParameter("id"));
String item = request.getParameter("item");
String ground = request.getParameter("ground");
String date = request.getParameter("date");
ArrayList list = new ArrayList();
list.add(id);
list.add(item);
list.add(ground);
list.add(date);
login.Update(list);
response.sendRedirect("admin.jsp");
%>
```

##更新方法

```java
public void Update(ArrayList list){
    try{
        Statement st=getConn().createStatement();
        st.executeUpdate("update session set item='"+list.get(1)+"',
                        ground='"+list.get(2)+"',date='"+list.get(3)+"'
                        where sessionid="+list.get(0));
    }catch(Exception e){
        e.printStackTrace();
    }
 }
```


# XML配置

```xml
<servlet>
    <servlet-name>HelloServlet</servlet-name>
    <servlet-class>cn.zero.jspproject.HelloServlet</servlet-class>
</servlet>

<servlet-mapping>
    <servlet-name>HelloServlet</servlet-name>
    <url-pattern>/</url-pattern>
</servlet-mapping>
```

